FLUXO DE DADOS ENTRE THREADS E BUFFERS

[THREAD 1 – USB Sniffer]
- Captura pacotes USB entre M3 <-> M4
- Timestamp sub-milisegundo
- Envia pacotes para Buffer Circular

[THREAD 2 – Parser & Logger]
- Recebe pacotes do Buffer Circular
- Extrai Track1/Track2, CVV, Banco, Nome
- Aplica compressão adaptativa
- Envia logs para BufferCircularLogs

[THREAD 3 – Buffer Circular Inteligente]
- FIFO thread-safe
- Overflow controlado
- Prioridade para pacotes críticos
- Fornece dados para Thread 4

[THREAD 4 – Criptografia + Armazenamento]
- Recebe logs do BufferCircularLogs
- Criptografia AES dinâmico por transação
- Hash SHA256 para integridade
- Redundância: microSD + memória interna
- Atualiza índice para M1

[THREAD 5 – Análise Offline (M1)]
- Descriptografa logs
- Verifica hash
- Analisa fluxo completo Chip/NFC